# -*- coding: utf-8 -*-
"""
Created on Mon May  4 14:58:46 2020

@author: gusto
"""

#============================================================================
def Euler(t, ht, y, n, Func):
#----------------------------------------------------------------------------
   f = [0]*(n+1)

   Func(t, y, f)
   for i in range(1, n+1): y[i] += ht * f[i]
#============================================================================
   
#============================================================================
def EulerPC(t, ht, y, n, Func):
#----------------------------------------------------------------------------

   f1 = [0]*(n+1); f2 = [0]*(n+1)
   yt = [0]*(n+1)

   Func(t, y, f1)
   for i in range(1, n+1): yt[i] = y[i] + ht * f1[i]
   Func(t+ht, yt, f2)

   ht2 = ht/2e0
   for i in range(1, n+1): y[i] += ht2 * (f1[i] + f2[i])
#============================================================================
   
#============================================================================
def RungeKutta(t, ht, y, n, Func):
#----------------------------------------------------------------------------
   f1 = [0]*(n+1); f2 = [0]*(n+1)
   f3 = [0]*(n+1); f4 = [0]*(n+1)
   yt = [0]*(n+1)

   ht2 = ht/2e0
   Func(t, y, f1)
   for i in range(1,n+1): yt[i] = y[i] + ht2*f1[i]
   Func(t+ht2, yt, f2)
   for i in range(1,n+1): yt[i] = y[i] + ht2*f2[i]
   Func(t+ht2, yt, f3)
   for i in range(1,n+1): yt[i] = y[i] + ht *f3[i]
   Func(t+ht, yt, f4)

   h6 = ht/6e0
   for i in range(1, n+1): y[i] += h6*(f1[i] + 2*(f2[i] + f3[i]) + f4[i])
#============================================================================
   
#============================================================================
def Euler1(t, ht, y, dy, Func):
#----------------------------------------------------------------------------
   d2y = Func(t, y, dy)

   y  += ht * dy
   dy += ht * d2y
   return (y, dy)
#============================================================================
   
#============================================================================
def EulerCromer1(t, ht, y, dy, Func):
#----------------------------------------------------------------------------
   d2y = Func(t, y, dy)

   dy += ht * d2y
   y  += ht * dy
   return (y, dy)

#============================================================================
def Verlet1(t, ht, y, dy, d2y, Func):
#----------------------------------------------------------------------------
   ht2 = 0.5e0 * ht
   dy += ht2 * d2y
   y  += ht  * dy

   d2y = Func(t, y, dy)

   dy += ht2 * d2y
   return (y, dy, d2y)
#============================================================================